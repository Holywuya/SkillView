# MOD配置详细指南

## 目录
1. [MOD配置文件格式](#mod配置文件格式)
2. [MOD品质系统](#mod品质系统)
3. [MOD属性体系](#mod属性体系)
4. [MOD分类详解](#mod分类详解)
5. [配置示例与最佳实践](#配置示例与最佳实践)

---

## MOD配置文件格式

### 文件位置
```
resources/mods.yml
```

### 基础YAML结构

每个MOD的配置遵循以下格式:

```yaml
MOD_ID:                           # MOD的唯一标识符 (英文,无空格)
  display: "&c&lMOD显示名称"      # 游戏内显示名称 (支持ChatColor代码)
  description: "MOD的功能描述"     # UI中显示的功能说明
  material: "PAPER"               # 物品材质 (Bukkit Material名称)
  rarity: "精良"                  # 品质等级 (普通/精良/稀有/史诗)
  polarity: "V"                   # 极性标记 (v1.5.2.4已禁用,仅作标记)
  base-drain: 4                   # 0级时的容量消耗值
  drain-step: 1                   # 每升一级增加的容量消耗
  attributes:                     # 属性映射表
    "属性名": 数值                 # 每级增加的属性数值
    "属性名2": 数值2
  max-level: 10                   # MOD的最大可升级等级
  tags: ["分类", "子分类"]         # MOD分类标签 (用于筛选)
```

---

## MOD品质系统

### 品质等级表

| 品质 | 颜色 | 容量消耗系数 | 升级成本 | 用途 | 等级上限 |
|------|------|-----------|--------|------|--------|
| 普通 (Common) | 白色 `&f` | 1.0x | 低 | 基础属性强化 | 10 |
| 精良 (Uncommon) | 绿色 `&a` | 1.2x | 中 | 单一强力属性 | 10 |
| 稀有 (Rare) | 蓝色 `&9` | 1.5x | 较高 | 多属性/复合效果 | 5 |
| 史诗 (Epic) | 紫色 `&5` | 2.0x | 高 | 顶级效果/堕落MOD | 3 |

### 品质选择指南

**普通品质 (Common)**
- 用于基础属性 (生命、护甲、魔力)
- 升级消耗最少
- 推荐等级上限: 10级

**精良品质 (Uncommon)**
- 用于单一强力属性 (暴击率、伤害加成)
- 平衡的容量消耗
- 推荐等级上限: 10级或5级

**稀有品质 (Rare)**
- 用于多属性或复合效果
- 容量消耗较高
- 推荐等级上限: 5级

**史诗品质 (Epic)**
- 用于顶级效果或"堕落"MOD
- 容量消耗最高
- 推荐等级上限: 3级

---

## MOD属性体系

### 所有可用属性

| 属性名 | NBT路径 | 数据类型 | 单位 | 正负性 | 说明 |
|--------|--------|--------|------|------|------|
| 伤害加成 | `Mod属性.伤害加成` | Double | % | ±  | 百分比伤害加成 |
| 最终伤害 | `Mod属性.最终伤害` | Double | 倍数 | + | 最后应用的乘数 |
| 火焰伤害 | `Mod属性.火焰伤害` | Double | % | + | 元素伤害加成 |
| 冰冻伤害 | `Mod属性.冰冻伤害` | Double | % | + | 元素伤害加成 |
| 状态几率 | `Mod属性.状态几率` | Double | % | + | 触发异常状态的概率 |
| 护甲 | `Mod属性.护甲` | Double | 点 | ± | 绝对护甲值 |
| 盾牌强度 | `Mod属性.盾牌强度` | Double | 点 | ± | 盾牌耐久值 |
| 火焰抗性 | `Mod属性.火焰抗性` | Double | % | + | 伤害抗性 |
| 冰冻抗性 | `Mod属性.冰冻抗性` | Double | % | + | 伤害抗性 |
| 闪电抗性 | `Mod属性.闪电抗性` | Double | % | + | 伤害抗性 |
| 最大生命 | `Mod属性.最大生命` | Double | 点 | ± | 绝对血量值 |
| 魔力上限 | `Mod属性.魔力上限` | Double | 点 | ± | 绝对魔力值 |
| 生命吸取 | `Mod属性.生命吸取` | Double | 比率 | + | 伤害转化为生命 |
| 能量回复 | `Mod属性.能量回复` | Double | 点/s | ± | 每秒魔力恢复 |
| 额外范围 | `Mod属性.额外范围` | Double | % | ± | 技能范围增加 |
| 技能强度 | `Mod属性.技能强度` | Double | 倍数 | ± | 技能效果倍率 |
| 技能效率 | `Mod属性.技能效率` | Double | % | ± | 魔力消耗减少 |
| 冷却缩减 | `Mod属性.冷却缩减` | Double | 秒 | ± | 技能冷却时间 |
| 移动速度 | `Mod属性.移动速度` | Double | % | ± | 移动速度加成 |
| 攻击速度 | `Mod属性.攻击速度` | Double | % | ± | 攻击速度加成 |
| 感知范围 | `Mod属性.感知范围` | Double | 格 | ± | 视野距离增加 |
| 跳跃高度 | `Mod属性.跳跃高度` | Double | % | + | 跳跃距离加成 |
| 反应速度 | `Mod属性.反应速度` | Double | % | + | 操作反应倍率 |
| 防御削弱 | `Mod属性.防御削弱` | Double | % | - | 负面属性 |
| 生命消耗 | `Mod属性.生命消耗` | Double | 点 | - | 每次使用损失血量 |
| 魔力恢复 | `Mod属性.魔力恢复` | Double | 点/s | ± | 主动回复速度 |
| 团队护盾 | `Mod属性.团队护盾` | Double | 倍数 | + | 队友护盾强度 |
| 治疗范围 | `Mod属性.治疗范围` | Double | 格 | + | 治疗技能范围 |

### 属性正负性说明

- **正值 (+)** = 增益效果 (通常为绿色MOD)
- **负值 (-)** = 负面效果 (通常为红色/"堕落"MOD)
- **±** = 可正可负,取决于配置

---

## MOD分类详解

### 1. 攻击类 (伤害强化)

功能: 增强武器和技能伤害

**代表MOD:**
- **Serration** (膛线) - 基础伤害加成
- **Hellfire** (地狱火焰) - 火焰元素伤害
- **Frostbite** (寒冰之刃) - 冰冻元素伤害
- **SplitChamber** (分裂弹头) - 最终伤害倍率
- **CriticalChance** (精准打击) - 暴击率
- **CriticalDamage** (致命一击) - 暴击伤害倍数
- **StatusChance** (诅咒符文) - 异常状态几率

**特点:**
- 容量消耗: 低～中
- 应用场景: 输出职业必备
- 堆叠效果: 可多个MOD叠加

---

### 2. 防御类 (抗性与护甲)

功能: 增强防御能力

**代表MOD:**
- **SteelSkin** (钢铁皮肤) - 护甲值增加
- **Redirection** (方向盾牌) - 盾牌强度增加
- **FlameResistance** (炎热防护) - 火焰伤害抗性
- **FrostResistance** (极寒防护) - 冰冻伤害抗性
- **LightningResistance** (绝缘防护) - 闪电伤害抗性

**特点:**
- 容量消耗: 低
- 应用场景: 防御职业必备
- 堆叠效果: 多个抗性MOD可同时装备

---

### 3. 生存类 (生命与能量)

功能: 增加生命值和能量储备

**代表MOD:**
- **Vitality** (生命力) - 最大生命值增加
- **Flow** (川流不息) - 最大魔力增加
- **LifeLeech** (生命汲取) - 伤害转化为生命
- **EnergyRegeneration** (能量流动) - 魔力回复速度

**特点:**
- 容量消耗: 低～中
- 应用场景: 提升生存能力
- 堆叠效果: 多个生存MOD效果叠加

---

### 4. 技能类 (效率与增强)

功能: 强化技能效果和管理

**代表MOD:**
- **Streamline** (简化) - 魔力消耗减少
- **Stretch** (延伸) - 技能范围增加
- **Continuity** (持久化) - 技能持续时间增加
- **Intensify** (强化) - 技能效果强度增加
- **FleetingExpertise** (瞬时转场) - 冷却缩减 + 效率负面
- **Overextend** (越界) - 极大范围增加 + 伤害削弱

**特点:**
- 容量消耗: 低～高
- 应用场景: 技能优化
- 堆叠效果: 多个技能MOD可结合使用

**复合MOD (堕落MOD):**
- 包含正面和负面属性
- 品质通常为史诗
- 需要仔细权衡利弊

---

### 5. 工具类 (通用辅助)

功能: 提升操作能力和机动性

**代表MOD:**
- **Rush** (急速) - 移动速度增加
- **Haste** (迅捷) - 攻击速度增加
- **Vigilance** (警惕) - 感知范围增加

**特点:**
- 容量消耗: 低
- 应用场景: 通用优化
- 效果: 提升游戏体验

---

### 6. 特殊类 (游戏特有)

功能: 独特效果和高级玩法

**代表MOD:**
- **Reflexes** (反射神经) - 跳跃与反应增强
- **Berserk** (狂暴) - 攻击力大幅提升 + 防御削弱 (堕落)
- **Sacrifice** (献祭) - 伤害增加 + 生命消耗 (堕落)
- **Sanctuary** (圣殿) - 队友护盾与治疗支援

**特点:**
- 容量消耗: 中～高
- 应用场景: 高级优化和支援
- 风险: 某些堕落MOD有重大负面效果

---

## 配置示例与最佳实践

### 示例1: 基础伤害MOD (普通品质)

```yaml
Serration: # 膛线
  display: "&c&l膛线"
  description: "增加武器基础伤害"
  material: "PAPER"
  rarity: "普通"
  polarity: "V"
  base-drain: 4
  drain-step: 1
  attributes:
    "伤害加成": 15.0          # 每级 +15%
  max-level: 10
  tags: ["攻击", "基础", "伤害"]
```

**配置说明:**
- 品质 = 普通: 新手友好,容易获取
- base-drain = 4: 0级消耗4点容量
- 等级10时: 总消耗 = 4 + (10 × 1) = 14点
- max-level = 10: 可升级到10级
- 单一属性: 仅提供伤害加成

---

### 示例2: 复合MOD (史诗品质)

```yaml
FleetingExpertise: # 瞬时转场
  display: "&b&l瞬时转场"
  description: "降低技能冷却时间,但降低技能效率"
  material: "PAPER"
  rarity: "史诗"
  polarity: "="
  base-drain: 6
  drain-step: 1
  attributes:
    "技能效率": 10.0          # 正面: 每级 +10% (5级时 +50%)
    "冷却缩减": -10.0         # 负面: 每级 -10% (5级时 -50%)
  max-level: 5
  tags: ["技能", "堕落", "复合"]
```

**配置说明:**
- 品质 = 史诗: 高等级MOD,容量消耗高
- base-drain = 6: 0级消耗6点容量
- 等级5时: 总消耗 = 6 + (5 × 1) = 11点
- max-level = 5: 仅可升级到5级 (平衡性考虑)
- 双属性: 一正一负,需要权衡

**使用场景:**
- 用于需要频繁使用技能的职业
- 需要额外装备冷却缩减抵消MOD的负面
- 高级玩家的优化选择

---

### 示例3: 元素伤害MOD (稀有品质)

```yaml
Hellfire: # 地狱火焰
  display: "&6&l地狱火焰"
  description: "增加火焰伤害"
  material: "PAPER"
  rarity: "稀有"
  polarity: "V"
  base-drain: 6
  drain-step: 1
  attributes:
    "火焰伤害": 40.0           # 每级 +40% 火焰伤害
    "状态几率": 5.0            # 每级 +5% 异常状态几率
  max-level: 5
  tags: ["攻击", "元素", "火焰"]
```

**配置说明:**
- 品质 = 稀有: 高品质,多重属性
- 多个属性: 火焰伤害 + 状态几率
- 容量消耗: 6 + (5 × 1) = 11点 (较高)
- 适用于: 使用火系技能的角色

---

### 示例4: 防守支援MOD (稀有品质)

```yaml
Sanctuary: # 圣殿
  display: "&f&l圣殿"
  description: "为周围队友提供护盾"
  material: "PAPER"
  rarity: "稀有"
  polarity: "="
  base-drain: 6
  drain-step: 1
  attributes:
    "团队护盾": 1.0            # 每级 +1.0倍护盾强度
    "治疗范围": 15.0           # 每级 +15格范围
  max-level: 5
  tags: ["特殊", "支援", "治疗"]
```

**配置说明:**
- 用于支援类角色
- 团队向MOD
- 多人游戏优先装备

---

### 最佳实践指南

#### 1. 容量管理

```
总容量: 60点 (假设)

推荐配置:
- 攻击类: 20点 (2-3个MOD)
- 防守类: 15点 (2-3个MOD)
- 生存类: 10点 (1-2个MOD)
- 技能强化: 15点 (2-3个MOD)
```

#### 2. MOD选择逻辑

```
输出职业配置:
├─ Serration (伤害)
├─ CriticalChance (暴击率)
├─ CriticalDamage (暴击伤害)
└─ Intensify (技能强度)

防守职业配置:
├─ SteelSkin (护甲)
├─ Vitality (生命)
├─ FlameResistance (火焰抗性)
└─ EnergyRegeneration (能量恢复)

技能优化配置:
├─ Streamline (效率)
├─ Stretch (范围)
├─ Continuity (持续)
└─ FleetingExpertise (冷却)
```

#### 3. 堕落MOD使用建议

堕落MOD适合:
- 有经验的玩家
- 能充分发挥正面属性
- 能接受或抵消负面属性

常见堕落MOD:
- **FleetingExpertise**: 用冷却缩减换效率
- **Overextend**: 用范围换伤害
- **Berserk**: 用攻击换防御
- **Sacrifice**: 用伤害换生命

---

## 属性计算公式

### 伤害计算

```
最终伤害 = 基础伤害
         × (1 + 伤害加成% / 100)
         × 技能倍率
         × 最终伤害倍数
         × (1 + 技能强度% / 100)
```

### 容量消耗

```
容量 = base-drain + (当前等级 × drain-step)
```

### 技能冷却

```
实际冷却 = 基础冷却 - 冷却缩减
```

### 魔力消耗

```
实际消耗 = 基础消耗 × (1 - 技能效率% / 100) - 魔力减耗
```

---

## 版本兼容性

### v1.5.2.4 及之后

- ✅ polarity 字段保留但仅作标记
- ✅ 容量计算不受极性影响
- ✅ 所有属性正常工作
- ⚠️ 旧存档中的极性折扣已移除

### 升级建议

- 不需要修改现有MOD配置
- 现有存档自动兼容
- 旧版本极性折扣不再生效

---

## FAQ

**Q: 可以添加自定义属性吗?**
A: 可以。在 `attributes` 中添加新的属性名-值对,代码中相应处理即可。

**Q: 如何平衡MOD力度?**
A: 
- 参考现有MOD的base-drain和属性值
- 保持容量消耗与效果匹配
- 考虑职业差异

**Q: 堕落MOD应该如何设计?**
A: 
- 负面效果应明显但可接受
- 正面收益应显著
- 玩家能有充分选择

**Q: 如何测试新MOD?**
A: 
- 使用命令 `/skill give book <player> <skillId>` 测试
- 检查UI显示效果
- 验证属性计算

---

## 相关文件

- **MOD配置:** `resources/mods.yml`
- **MOD管理:** `core/mod/ModStats.kt`
- **属性应用:** `core/mod/SkillModLogic.kt`
- **NBT文档:** `docs/NBT-System-Guide.md`

---

## 更新历史

### v1.5.3.0
- MOD数量增加到30个
- 新增8个MOD类别分类
- 发布本配置详细指南

### v1.5.2.4
- 移除极性系统
- polarity字段变为纯标记

---

本文档遵循 GNU General Public License v3.0 协议。
